<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å®˜æ–¹ç½‘ç«™åå° API æ–‡æ¡£</title>
    <link rel="stylesheet" type="text/css" href="https://unpkg.com/swagger-ui-dist@3/swagger-ui.css">
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #fafafa;
        }

        .header {
            background: #4a90e2;
            color: white;
            padding: 20px;
            text-align: center;
        }

        .header h1 {
            margin: 0;
            font-size: 24px;
        }

        .header p {
            margin: 5px 0 0 0;
            opacity: 0.9;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            min-height: 80vh;
        }

        .info-box {
            background: #e3f2fd;
            border: 1px solid #2196f3;
            border-radius: 4px;
            padding: 15px;
            margin: 20px;
        }

        .api-list {
            padding: 20px;
        }

        .api-item {
            border: 1px solid #ddd;
            border-radius: 4px;
            margin: 10px 0;
            padding: 15px;
        }

        .api-item h3 {
            margin: 0 0 10px 0;
            color: #333;
        }

        .method {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 3px;
            color: white;
            font-size: 12px;
            font-weight: bold;
            margin-right: 10px;
        }

        .get {
            background: #61affe;
        }

        .post {
            background: #49cc90;
        }

        .put {
            background: #fca130;
        }

        .delete {
            background: #f93e3e;
        }

        .patch {
            background: #50e3c2;
        }
    </style>
</head>

<body>
    <div class="header">
        <h1>ğŸš€ å®˜æ–¹ç½‘ç«™åå° API æ–‡æ¡£</h1>
        <p>RESTful API æ¥å£æ–‡æ¡£å’Œæµ‹è¯•å·¥å…·</p>
    </div>

    <div class="container">
        <div class="info-box">
            <h3>ğŸ“– ä½¿ç”¨è¯´æ˜</h3>
            <p><strong>è®¤è¯æ–¹å¼:</strong> JWT Bearer Token</p>
            <p><strong>Base URL:</strong> <code id="baseUrl">http://localhost:8001</code></p>
        </div>

        <div id="swagger-ui"></div>

        <div class="api-list">
            <h2>ğŸ“‹ API ç«¯ç‚¹åˆ—è¡¨</h2>

            <div class="api-item">
                <h3><span class="method get">GET</span> /api/health</h3>
                <p><strong>æè¿°:</strong> å¥åº·æ£€æŸ¥æ¥å£</p>
                <p><strong>è®¤è¯:</strong> ä¸éœ€è¦</p>
            </div>

            <div class="api-item">
                <h3><span class="method get">GET</span> /api/test</h3>
                <p><strong>æè¿°:</strong> æµ‹è¯•æ¥å£</p>
                <p><strong>è®¤è¯:</strong> ä¸éœ€è¦</p>
            </div>

            <div class="api-item">
                <h3><span class="method get">GET</span> /api/info</h3>
                <p><strong>æè¿°:</strong> API ç³»ç»Ÿä¿¡æ¯</p>
                <p><strong>è®¤è¯:</strong> ä¸éœ€è¦</p>
            </div>

            <div class="api-item">
                <h3><span class="method get">GET</span> /official-api/news</h3>
                <p><strong>æè¿°:</strong> è·å–æ–°é—»æ–‡ç« åˆ—è¡¨</p>
                <p><strong>è®¤è¯:</strong> éœ€è¦ JWT Token</p>
                <p><strong>å‚æ•°:</strong> page, limit, status, categoryCode ç­‰</p>
            </div>

            <div class="api-item">
                <h3><span class="method post">POST</span> /official-api/news</h3>
                <p><strong>æè¿°:</strong> åˆ›å»ºæ–°é—»æ–‡ç« </p>
                <p><strong>è®¤è¯:</strong> éœ€è¦ JWT Token</p>
                <p><strong>è¯·æ±‚ä½“:</strong> name, cover, content, category ç­‰</p>
            </div>

            <div class="api-item">
                <h3><span class="method get">GET</span> /official-api/news/{id}</h3>
                <p><strong>æè¿°:</strong> è·å–å•ä¸ªæ–°é—»æ–‡ç« </p>
                <p><strong>è®¤è¯:</strong> éœ€è¦ JWT Token</p>
            </div>

            <div class="api-item">
                <h3><span class="method put">PUT</span> /official-api/news/{id}</h3>
                <p><strong>æè¿°:</strong> æ›´æ–°æ–°é—»æ–‡ç« </p>
                <p><strong>è®¤è¯:</strong> éœ€è¦ JWT Token</p>
            </div>

            <div class="api-item">
                <h3><span class="method delete">DELETE</span> /official-api/news/{id}</h3>
                <p><strong>æè¿°:</strong> åˆ é™¤æ–°é—»æ–‡ç« </p>
                <p><strong>è®¤è¯:</strong> éœ€è¦ JWT Token</p>
            </div>

            <div class="api-item">
                <h3><span class="method patch">PATCH</span> /official-api/news/{id}/status</h3>
                <p><strong>æè¿°:</strong> è®¾ç½®æ–‡ç« çŠ¶æ€</p>
                <p><strong>è®¤è¯:</strong> éœ€è¦ JWT Token</p>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/swagger-ui-dist@3/swagger-ui-bundle.js"></script>
    <script src="https://unpkg.com/swagger-ui-dist@3/swagger-ui-standalone-preset.js"></script>
    <script>
        // æ‰‹åŠ¨æ„å»º API æ–‡æ¡£
        const apiDoc = {
            openapi: '3.0.0',
            info: {
                title: 'å®˜æ–¹ç½‘ç«™åå° API',
                version: '2.0.0',
                description: 'å®˜æ–¹ç½‘ç«™åå°ç³»ç»ŸAPIæ–‡æ¡£\n\n## è®¤è¯è¯´æ˜\næœ¬APIä½¿ç”¨JWT Bearer Tokenè¿›è¡Œè®¤è¯ã€‚è¯·åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ ï¼š\n`Authorization: Bearer <your_jwt_token>`'
            },
            servers: [
                { url: 'http://localhost:8000', description: 'Symfony æœåŠ¡å™¨ (ä¸»è¦API)' },
                { url: 'http://localhost:8001', description: 'ç®€å•APIæœåŠ¡å™¨ (å¸¦CORSä¿®å¤)' },
                { url: 'http://localhost:8002', description: 'æµ‹è¯•æœåŠ¡å™¨' }
            ],
            components: {
                securitySchemes: {
                    bearerAuth: {
                        type: 'http',
                        scheme: 'bearer',
                        bearerFormat: 'JWT',
                        description: 'JWT Bearer Tokenè®¤è¯'
                    }
                }
            },
            security: [
                { bearerAuth: [] }
            ],
            paths: {
                '/api/health': {
                    get: {
                        summary: 'å¥åº·æ£€æŸ¥',
                        description: 'å¥åº·æ£€æŸ¥æ¥å£ï¼Œç”¨äºéªŒè¯APIæœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ',
                        tags: ['ç³»ç»ŸçŠ¶æ€'],
                        responses: {
                            200: {
                                description: 'æœåŠ¡æ­£å¸¸',
                                content: {
                                    'application/json': {
                                        schema: {
                                            type: 'object',
                                            properties: {
                                                status: { type: 'string', example: 'ok' },
                                                timestamp: { type: 'string', example: '2025-11-25T05:35:00+00:00' },
                                                service: { type: 'string', example: 'å®˜æ–¹ç½‘ç«™åå°API' },
                                                version: { type: 'string', example: '2.0.0' }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                },
                '/api/test': {
                    get: {
                        summary: 'æµ‹è¯•API',
                        description: 'æµ‹è¯•APIç«¯ç‚¹',
                        tags: ['æµ‹è¯•'],
                        responses: {
                            200: {
                                description: 'æˆåŠŸå“åº”',
                                content: {
                                    'application/json': {
                                        schema: {
                                            type: 'object',
                                            properties: {
                                                message: { type: 'string', example: 'Hello World' }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                },
                '/official-api/news': {
                    get: {
                        summary: 'è·å–æ–°é—»æ–‡ç« åˆ—è¡¨',
                        description: 'è·å–æ–°é—»æ–‡ç« åˆ—è¡¨ï¼Œæ”¯æŒå¤šæ¡ä»¶æŸ¥è¯¢å’Œåˆ†é¡µ',
                        tags: ['æ–°é—»æ–‡ç« ç®¡ç†'],
                        security: [{ bearerAuth: [] }],
                        parameters: [
                            { name: 'page', in: 'query', schema: { type: 'integer', default: 1 }, description: 'é¡µç ï¼ˆä»1å¼€å§‹ï¼‰' },
                            { name: 'limit', in: 'query', schema: { type: 'integer', default: 20 }, description: 'æ¯é¡µæ•°é‡' },
                            { name: 'status', in: 'query', schema: { type: 'integer' }, description: 'çŠ¶æ€ï¼ˆ1=æ¿€æ´»ï¼Œ2=éæ¿€æ´»ï¼‰' },
                            { name: 'categoryCode', in: 'query', schema: { type: 'string' }, description: 'åˆ†ç±»ç¼–ç ' }
                        ],
                        responses: {
                            200: {
                                description: 'è·å–æˆåŠŸ',
                                content: {
                                    'application/json': {
                                        schema: {
                                            type: 'object',
                                            properties: {
                                                code: { type: 'integer', example: 200 },
                                                message: { type: 'string', example: 'success' },
                                                data: {
                                                    type: 'object',
                                                    properties: {
                                                        items: { type: 'array', items: { type: 'object' } },
                                                        total: { type: 'integer', example: 100 },
                                                        page: { type: 'integer', example: 1 },
                                                        limit: { type: 'integer', example: 20 }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    post: {
                        summary: 'åˆ›å»ºæ–°é—»æ–‡ç« ',
                        description: 'åˆ›å»ºæ–°çš„æ–°é—»æ–‡ç« ',
                        tags: ['æ–°é—»æ–‡ç« ç®¡ç†'],
                        security: [{ bearerAuth: [] }],
                        requestBody: {
                            required: true,
                            content: {
                                'application/json': {
                                    schema: {
                                        type: 'object',
                                        required: ['name', 'cover', 'content', 'category'],
                                        properties: {
                                            name: { type: 'string', description: 'æ–‡ç« åç§°' },
                                            cover: { type: 'string', description: 'å°é¢å›¾ç‰‡' },
                                            content: { type: 'string', description: 'æ–‡ç« å†…å®¹' },
                                            category: { type: 'string', description: 'åˆ†ç±»IDæˆ–åˆ†ç±»ç¼–ç ' },
                                            status: { type: 'integer', description: 'çŠ¶æ€ï¼ˆ1=æ¿€æ´»ï¼Œ2=éæ¿€æ´»ï¼‰' }
                                        }
                                    }
                                }
                            }
                        },
                        responses: {
                            201: {
                                description: 'åˆ›å»ºæˆåŠŸ',
                                content: {
                                    'application/json': {
                                        schema: {
                                            type: 'object',
                                            properties: {
                                                code: { type: 'integer', example: 201 },
                                                message: { type: 'string', example: 'åˆ›å»ºæˆåŠŸ' },
                                                data: { type: 'object' }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        };

        // åˆå§‹åŒ– Swagger UI
        const ui = SwaggerUIBundle({
            spec: apiDoc,
            dom_id: '#swagger-ui',
            deepLinking: true,
            presets: [
                SwaggerUIBundle.presets.apis,
                SwaggerUIStandalonePreset
            ],
            plugins: [
                SwaggerUIBundle.plugins.DownloadUrl
            ],
            layout: "StandaloneLayout",
            supportedSubmitMethods: ['get', 'post', 'put', 'delete', 'patch'],
            tryItOutEnabled: true,
            requestInterceptor: function (request) {
                request.headers['Accept'] = 'application/json';
                return request;
            }
        });

        // åŠ¨æ€æ›´æ–° Base URL å’ŒæœåŠ¡å™¨é€‰æ‹©
        function updateServerUrl() {
            const currentPort = window.location.port;
            let serverUrl = 'http://localhost:8000'; // é»˜è®¤SymfonyæœåŠ¡å™¨

            // æ ¹æ®å½“å‰è®¿é—®çš„ç«¯å£æ™ºèƒ½é€‰æ‹©APIæœåŠ¡å™¨
            if (currentPort === '8000') {
                serverUrl = 'http://localhost:8000';
            } else if (currentPort === '8001') {
                serverUrl = 'http://localhost:8001';
            } else if (currentPort === '8002') {
                serverUrl = 'http://localhost:8002';
            }

            document.getElementById('baseUrl').textContent = serverUrl;

            // æ›´æ–°Swagger UIçš„æœåŠ¡å™¨URL
            if (window.ui) {
                window.ui.specActions.updateServer(serverUrl);
            }
        }

        // é¡µé¢åŠ è½½å®Œæˆåæ›´æ–°URL
        document.addEventListener('DOMContentLoaded', function () {
            updateServerUrl();
        });

        // å°†uiå¯¹è±¡æš´éœ²åˆ°å…¨å±€ä½œç”¨åŸŸä»¥ä¾¿æ›´æ–°
        window.ui = ui;


    </script>
</body>

</html>